<!DOCTYPE html>
<html lang="en">
 <head>
  <title>Github Test Site</title>
</head>
<body>
 <div>
  <section>
   <heading>
    <h1>Ryan J Shih</h1>
    <h3>import RPi.GPIO as GPIO
import time

# Use the BCM pin numbering scheme (GPIO numbers, not board physical pin numbers)
GPIO.setmode(GPIO.BCM)
# Suppress warnings
GPIO.setwarnings(False)

# Define the GPIO pin connected to the sensor's OUT pin (using GPIO 17 as an example)
HALL_PIN = 17

# Global variable to store the count of magnet passes
sensor_counter = 0

def sensor_callback(channel):
    """
    This function is called every time a magnet is detected.
    """
    global sensor_counter
    sensor_counter += 1
    # Optional: print a message every time a magnet is detected
    # print("Magnet detected! Current count: ", sensor_counter)

def main():
    print("Hall sensor test program running...")
    print("Press Ctrl+C to exit.")

    # Set the HALL_PIN as an input pin
    # Use internal pull-up resistor, as many sensors have open-collector outputs
    GPIO.setup(HALL_PIN, GPIO.IN, pull_up_down=GPIO.PUD_UP)

    # Add an event detection (interrupt) on the falling edge of the signal
    # The falling edge usually indicates a magnet is present with a pull-up resistor
    GPIO.add_event_detect(HALL_PIN, GPIO.FALLING, callback=sensor_callback, bouncetime=300)

    try:
        while True:
            # Main loop keeps the script running
            # Print the total count every few seconds
            print(f"Total magnet detections: {sensor_counter}")
            time.sleep(2)

    except KeyboardInterrupt:
        # Clean up GPIO settings when the program is interrupted by the user
        GPIO.cleanup()
        print("\nProgram exited and GPIO cleaned up.")

if __name__ == "__main__":
    main()
</h3>
   </heading>
  </section>
 </body>
</html>
